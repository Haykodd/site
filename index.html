<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Mode Clicker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 
      Это автономная версия. 
      Код Firebase (для счетчика) был удален.
    -->
    <script type="module">
        // Ждем загрузки DOM
        document.addEventListener('DOMContentLoaded', () => {

            // --- КАРТИНКИ РЕЖИМОВ ---
            const modeImages = {
                kraken: 'Kraken.png',
                baal: 'TBaal.png',
                juzo: 'Juzo.png',
                hawkEye: 'Mihawk.png',
                roger: 'Roger.png',
                law: 'Law.png',
                gravito: 'Gravito.webp',
                christmasPresents: 'https://placehold.co/300x300/10B981/FFFFFF?text=Christmas+Presents',
                legendaryChest: 'https://placehold.co/300x300/EAB308/1F2937?text=Legendary+Chest',
                mythicalChest: 'https://placehold.co/300x300/EF4444/1F2937?text=Mythical+Chest',
                rareChest: 'https://placehold.co/300x300/3B82F6/1F2937?text=Rare+Chest'
            };

            // --- ЭЛЕМЕНТЫ DOM ---
            const modeSelector = document.getElementById('modeSelector');
            const gameContainer = document.getElementById('gameContainer');
            const clickerTitle = document.getElementById('clickerTitle');
            const killCountLabel = document.getElementById('killCountLabel');

            // Режимы
            const modes = ['Kraken', 'Baal', 'Juzo', 'HawkEye', 'Roger', 'Law', 'Gravito', 'ChristmasPresents', 'LegendaryChest', 'MythicalChest', 'RareChest'];
            const selectors = {};
            modes.forEach(m => selectors[m] = document.getElementById(`select${m}`));

            const resetModeButton = document.getElementById('resetModeButton');
            const imageUpload = document.getElementById('imageUpload');
            const clickTarget = document.getElementById('clickTarget');
            const clickCountDisplay = document.getElementById('clickCountDisplay');

            // Кнопки открытия (НОВОЕ)
            const btnX1 = document.getElementById('btnX1');
            const btnX10 = document.getElementById('btnX10');
            const btnX100 = document.getElementById('btnX100');

            // Блоки шансов
            const chanceBlocks = {};
            ['kraken', 'baal', 'juzo', 'hawkEye', 'roger', 'law', 'gravito', 'christmasPresents', 'legendaryChest', 'mythicalChest', 'rareChest'].forEach(m => {
                chanceBlocks[m] = document.getElementById(`${m}Chances`);
            });

            const fruitChancesContainer = document.getElementById('fruitChancesContainer');
            const fruitCollectionContainer = document.getElementById('fruitCollectionContainer');

            // Статистика
            const killCountEl = document.getElementById('killCount');
            const lastDropDisplay = document.getElementById('lastDropDisplay');
            const dropList = document.getElementById('dropList');
            const fruitCollectionList = document.getElementById('fruitCollectionList');

            // Переключатели
            const toggleASE = document.getElementById('toggleASE');
            const toggleLogia = document.getElementById('toggleLogia');
            const toggleGreatKraken = document.getElementById('toggleGreatKraken');
            const toggle2xDrop = document.getElementById('toggle2xDrop');
            const toggle4xDrop = document.getElementById('toggle4xDrop');
            const toggleLFCLogia = document.getElementById('toggleLFCLogia');
            const toggleRFCRLogia = document.getElementById('toggleRFCRLogia');

            // --- СОСТОЯНИЕ ИГРЫ ---
            let clickCount = 0;
            let killCount = 0;
            let currentMode = '';
            const CLICKS_PER_KILL = 1;

            let lastDroppedItemName = null;
            let lastDropListItem = null;
            let lastDropCount = 1;

            let isASEActive = false;
            let isLogiaActive = false;
            let isGreatKrakenActive = false;
            let is2xDropActive = false;
            let is4xDropActive = false;
            let isLFCLogiaActive = false;
            let isRFCRLogiaActive = false;

            let fruitCollection = {};

            // --- ДАННЫЕ ДРОПА ---
            const krakenRewards = [
                { name: "Mysterious Book", chance: 15, color: "text-gray-400" },
                { name: "Book of Spirits", chance: 45, color: "text-green-400" },
                { name: "Kraken Armor", chance: 1, color: "text-red-500" },
                { name: "Kraken Cape", chance: 5, color: "text-yellow-400" },
                { name: "Kraken Blade", chance: 1, color: "text-red-500" },
                { name: "Kraken Katana", chance: 1, color: "text-red-500" },
                { name: "Kraken Core", chance: 1, color: "text-red-500" },
                { name: "Devil Fruit", chance: 1, color: "text-purple-400" },
                { name: "Ничего", chance: 30, color: "text-gray-500" },
            ];
            const baalRewards = [
                { name: "True Ba'al's Snake Fire", chance: 20, color: "text-yellow-400" },
                { name: "True Ba'al's Snake Head", chance: 5, color: "text-purple-400" },
                { name: "True Ba'al's Horns", chance: 5, color: "text-purple-400" },
                { name: "True Ba'al's Guard", chance: 2, color: "text-purple-400" },
                { name: "Hollow's Great Sword", chance: 2, color: "text-purple-400" },
                { name: "Hollow's World Ender", chance: 1, color: "text-red-500" },
                { name: "Prestige World Ender", chance: 0.001, color: "text-red-500 animate-pulse" },
                { name: "Endbringer Wings", chance: 1, color: "text-red-500" },
                { name: "Endbringer Armor", chance: 1, color: "text-red-500" },
                { name: "Ничего", chance: 62.999, color: "text-gray-500" },
            ];
            const juzoRewards = [
                { name: "Kira Kira no Mi", chance: 5, color: "text-purple-400" },
                { name: "Turtleback Helmet", chance: 1, color: "text-purple-400" },
                { name: "Turtleback Armor", chance: 1, color: "text-purple-400" },
                { name: "Mythical Fruit Chest", chance: 0.5, color: "text-red-500" },
                { name: "Ничего", chance: 92.5, color: "text-gray-500" },
            ];
            const hawkEyeRewards = [
                { name: "Mihawk's hat", chance: 1, color: "text-purple-400" },
                { name: "Hawk Eye's Outfit", chance: 1, color: "text-purple-400" },
                { name: "Triple Strongest Slash Scroll", chance: 1, color: "text-purple-400" },
                { name: "Legendary fruit chest blue-print", chance: 1, color: "text-yellow-400" },
                { name: "Dark Blade", chance: 0.5, color: "text-red-500" },
                { name: "Ничего", chance: 95.5, color: "text-gray-500" },
            ];
            const rogerRewards = [
                { name: "Legendary Fruit Chest Blueprint", chance: 1, color: "text-yellow-400" },
                { name: "Roger's Hat", chance: 1, color: "text-yellow-400" },
                { name: "Roger's Outfit", chance: 1, color: "text-yellow-400" },
                { name: "Roger's Ace", chance: 0.5, color: "text-red-500" },
                { name: "Ничего", chance: 96.5, color: "text-gray-500" },
            ];
            const lawRewards = [
                { name: "Law's Outfit", chance: 15, color: "text-purple-400" },
                { name: "Law's Cape", chance: 15, color: "text-purple-400" },
                { name: "Law's Cap", chance: 5, color: "text-purple-400" },
                { name: "Ope Scramble", chance: 1, color: "text-yellow-400" },
                { name: "Kikoku", chance: 0.5, color: "text-red-500" },
                { name: "Ничего", chance: 63.5, color: "text-gray-500" },
            ];
            const gravitoRewards = [
                { name: "Gravito's Cape", chance: 35, color: "text-green-400" },
                { name: "Gravity Blade", chance: 15, color: "text-blue-400" },
                { name: "Hoverboard", chance: 1, color: "text-red-500" },
                { name: "Meteor Strike", chance: 1, color: "text-red-500" },
                { name: "Ничего", chance: 48, color: "text-gray-500" },
            ];
            const christmasRewards = [
                { name: "Iceborn candy cane", chance: 0.001, color: "text-black" },
                { name: "Candy cane", chance: 0.005, color: "text-red-400" },
                { name: "Ничего", chance: 99.994, color: "text-gray-500" }
            ];

            const fruitListsByRarity = {
                Common: ["Suke", "Kilo", "Spin", "Heal"],
                Rare: ["Bari", "Mero", "Horo", "Gomu", "Bomu"],
                Epic: ["Yomi", "Spring", "Kira"],
                Legendary: ["Mera", "Pika", "Hie", "Magu", "Goro", "Gura", "Zushi", "Suna", "Ito", "Paw", "Kage", "Yami", "Goru", "Smoke"],
                Mythical: ["Tori", "Mochi", "Ope", "Venom", "Buddha", "Pteranodon"]
            };

            const fruitRarityChances = {
                none: [{ name: "Common", chance: 59.5, color: "text-gray-300" }, { name: "Rare", chance: 26, color: "text-blue-400" }, { name: "Epic", chance: 10, color: "text-purple-400" }, { name: "Legendary", chance: 4, color: "text-yellow-400" }, { name: "Mythical", chance: 0.5, color: "text-red-500" }],
                oneActive: [{ name: "Common", chance: 54, color: "text-gray-300" }, { name: "Rare", chance: 26, color: "text-blue-400" }, { name: "Epic", chance: 10, color: "text-purple-400" }, { name: "Legendary", chance: 8, color: "text-yellow-400" }, { name: "Mythical", chance: 1, color: "text-red-500" }],
                bothActive: [{ name: "Common", chance: 44, color: "text-gray-300" }, { name: "Rare", chance: 26, color: "text-blue-400" }, { name: "Epic", chance: 10, color: "text-purple-400" }, { name: "Legendary", chance: 16, color: "text-yellow-400" }, { name: "Mythical", chance: 2, color: "text-red-500" }]
            };

            const lfcRarityChances = {
                none: [{ name: "Legendary", chance: 99.5, color: "text-yellow-400" }, { name: "Mythical", chance: 0.5, color: "text-red-500" }],
                oneActive: [{ name: "Legendary", chance: 99, color: "text-yellow-400" }, { name: "Mythical", chance: 1, color: "text-red-500" }]
            };

            const mfcRarityChances = {
                none: [{ name: "Mythical", chance: 100, color: "text-red-500" }],
                oneActive: [{ name: "Mythical", chance: 100, color: "text-red-500" }]
            };

            const rfcRarityChances = {
                none: [{ name: "Rare", chance: 87.5, color: "text-blue-400" }, { name: "Epic", chance: 10, color: "text-purple-400" }, { name: "Legendary", chance: 2, color: "text-yellow-400" }, { name: "Mythical", chance: 0.5, color: "text-red-500" }],
                oneActive: [{ name: "Rare", chance: 85, color: "text-blue-400" }, { name: "Epic", chance: 10, color: "text-purple-400" }, { name: "Legendary", chance: 4, color: "text-yellow-400" }, { name: "Mythical", chance: 1, color: "text-red-500" }]
            };

            // --- ЛОГИКА ---
            function getCurrentMultiplier() {
                if (is4xDropActive) return 4;
                if (is2xDropActive) return 2;
                return 1;
            }

            function setGameMode(mode) {
                currentMode = mode;
                modeSelector.classList.add('hidden');
                gameContainer.classList.remove('hidden');

                Object.values(chanceBlocks).forEach(el => el?.classList.add('hidden'));
                if (fruitChancesContainer) fruitChancesContainer.classList.add('hidden');
                if (fruitCollectionContainer) fruitCollectionContainer.classList.add('hidden');

                const modeTitleMap = {
                    kraken: "Kraken Clicker", baal: "True Ba'al Clicker", juzo: "Juzo Clicker",
                    hawkEye: "Hawk Eye Clicker", roger: "Roger Clicker", law: "Law Clicker",
                    gravito: "Gravito Clicker", christmasPresents: "Christmas Presents",
                    legendaryChest: "Legendary Fruit Chest", mythicalChest: "Mythical Fruit Chest",
                    rareChest: "Rare Fruit Chest"
                };

                if (clickerTitle) clickerTitle.textContent = modeTitleMap[mode] || "Clicker";
                if (killCountLabel) killCountLabel.textContent = mode.includes('Chest') || mode === 'christmasPresents' ? "Открыто:" : "Убито:";

                if (chanceBlocks[mode]) chanceBlocks[mode].classList.remove('hidden');
                if (mode === 'kraken') {
                    if (fruitChancesContainer) fruitChancesContainer.classList.remove('hidden');
                    if (fruitCollectionContainer) fruitCollectionContainer.classList.remove('hidden');
                }
                if (mode.includes('Chest')) {
                    if (fruitCollectionContainer) fruitCollectionContainer.classList.remove('hidden');
                }

                resetGame();
                clickTarget.src = modeImages[mode] || 'https://placehold.co/300x300?text=Click+Me';
            }

            function resetGame() {
                clickCount = 0;
                killCount = 0;
                lastDroppedItemName = null;
                lastDropListItem = null;
                lastDropCount = 1;
                fruitCollection = {};
                if (clickCountDisplay) clickCountDisplay.textContent = `0 / ${CLICKS_PER_KILL}`;
                if (killCountEl) killCountEl.textContent = '0';
                if (lastDropDisplay) {
                    lastDropDisplay.textContent = `Нажми 1 раз...`;
                    lastDropDisplay.className = "text-center text-gray-400 p-4 bg-gray-900 rounded-lg min-h-[60px] flex items-center justify-center";
                }
                if (dropList) dropList.innerHTML = '';
                if (fruitCollectionList) fruitCollectionList.innerHTML = '';
                updateAllChanceUI();
            }

            function getRewardFromList(rewardsList, useMultipliers = true) {
                let chances = [...rewardsList];
                const mult = useMultipliers ? getCurrentMultiplier() : 1;

                if (mult > 1) {
                    let multipliedChances = chances.map(item => {
                        if (item.name === "Ничего") return { ...item };
                        return { ...item, chance: item.chance * mult };
                    });
                    const totalChance = multipliedChances.reduce((acc, item) => item.name !== "Ничего" ? acc + item.chance : acc, 0);
                    const nothingItem = multipliedChances.find(item => item.name === "Ничего");
                    if (nothingItem) nothingItem.chance = Math.max(0, 100 - totalChance);
                    chances = multipliedChances;
                }

                const totalWeight = chances.reduce((acc, r) => acc + r.chance, 0);
                let random = Math.random() * totalWeight;
                for (const reward of chances) {
                    if (random < reward.chance) return reward;
                    random -= reward.chance;
                }
            }

            function getFruitReward(chanceSet, useModifiers) {
                let key = 'none';
                if (useModifiers) {
                    if (isASEActive && isLogiaActive) key = 'bothActive';
                    else if (isASEActive || isLogiaActive) key = 'oneActive';
                }
                let chancesList = chanceSet[key];
                const mult = useModifiers ? getCurrentMultiplier() : 1;

                if (mult > 1) {
                    let multiplied = chancesList.map(item => ({ ...item, chance: item.chance * mult }));
                    const total = multiplied.reduce((acc, i) => acc + i.chance, 0);
                    if (total > 100) {
                        const scale = 100 / total;
                        multiplied = multiplied.map(i => ({ ...i, chance: i.chance * scale }));
                    } else {
                        const common = multiplied.find(i => i.name === "Common");
                        if (common) common.chance += (100 - total);
                    }
                    chancesList = multiplied;
                }

                const rarity = getRewardFromList(chancesList, false);
                const list = fruitListsByRarity[rarity.name];
                return { name: list[Math.floor(Math.random() * list.length)], color: rarity.color, rarity: rarity.name };
            }

            function updateAllChanceUI() {
                const mult = getCurrentMultiplier();
                const updateNode = (id, base) => {
                    const el = document.getElementById(id);
                    if (el) el.textContent = (base * mult).toFixed(base < 1 ? 3 : 1);
                };

                updateNode('chance-k-book', 15); updateNode('chance-k-spirits', 45); updateNode('chance-k-armor', 1); updateNode('chance-k-cape', 5);
                updateNode('chance-k-blade', 1); updateNode('chance-k-katana', 1); updateNode('chance-k-core', 1); updateNode('chance-k-fruit', 1);
                updateNode('chance-b-guard', 2); updateNode('chance-b-sword', 2); updateNode('chance-b-head', 5); updateNode('chance-b-fire', 20);
                updateNode('chance-b-horns', 5); updateNode('chance-b-worldender', 1); updateNode('chance-b-prestige', 0.001); updateNode('chance-b-wings', 1); updateNode('chance-b-armor', 1);
                updateNode('chance-xm-cane-ice', 0.001); updateNode('chance-xm-cane-regular', 0.005);
                
                const xmNothing = document.getElementById('chance-xm-nothing');
                if (xmNothing) xmNothing.textContent = (100 - (0.006 * mult)).toFixed(3);

                updateNode('chance-j-kira', 5); updateNode('chance-j-chest', 0.5); updateNode('chance-h-blade', 0.5); updateNode('chance-r-ace', 0.5); updateNode('chance-l-kikoku', 0.5);

                let key = (isASEActive && isLogiaActive) ? 'bothActive' : (isASEActive || isLogiaActive ? 'oneActive' : 'none');
                let fList = fruitRarityChances[key].map(item => ({ ...item, chance: item.chance * mult }));
                const fTotal = fList.reduce((acc, i) => acc + i.chance, 0);
                if (fTotal > 100) fList = fList.map(i => ({ ...i, chance: i.chance * (100 / fTotal) }));
                else if (fList.find(i => i.name === "Common")) fList.find(i => i.name === "Common").chance += (100 - fTotal);

                const setF = (id, name) => { const el = document.getElementById(id); if (el) el.textContent = fList.find(i => i.name === name).chance.toFixed(1); };
                setF('chanceCommon', 'Common'); setF('chanceRare', 'Rare'); setF('chanceEpic', 'Epic'); setF('chanceLegendary', 'Legendary'); setF('chanceMythical', 'Mythical');
            }

            function displayReward(reward) {
                if (!reward || !reward.name || reward.name === "Ничего") {
                    if (lastDropDisplay) {
                        lastDropDisplay.textContent = "Ничего";
                        lastDropDisplay.className = "text-center text-gray-500 text-lg p-4 bg-gray-900 rounded-lg min-h-[60px] flex items-center justify-center";
                    }
                    lastDroppedItemName = "Ничего";
                    return;
                }
                const itemName = reward.name;
                const itemColor = reward.color || "text-gray-300";
                if (lastDropDisplay) {
                    lastDropDisplay.textContent = itemName;
                    lastDropDisplay.className = `text-center text-lg p-4 bg-gray-900 rounded-lg min-h-[60px] flex items-center justify-center font-bold ${itemColor}`;
                }

                if (itemName === lastDroppedItemName && lastDropListItem) {
                    lastDropCount++;
                    lastDropListItem.querySelector('span.count-badge').textContent = `x${lastDropCount}`;
                } else {
                    lastDropCount = 1;
                    lastDroppedItemName = itemName;
                    const li = document.createElement('li');
                    li.className = `flex justify-between items-center ${itemColor} font-medium py-1`;
                    li.innerHTML = `<p>${itemName}</p><span class="count-badge text-sm text-gray-400"></span>`;
                    if (dropList) dropList.prepend(li);
                    lastDropListItem = li;
                }

                const allFruits = [].concat(...Object.values(fruitListsByRarity));
                if (allFruits.includes(itemName) || itemName === "Kira Kira no Mi") {
                    const fruitKey = itemName === "Kira Kira no Mi" ? "Kira" : itemName;
                    fruitCollection[fruitKey] = (fruitCollection[fruitKey] || 0) + 1;
                    let fLi = document.getElementById(`f-${fruitKey}`);
                    if (!fLi) {
                        fLi = document.createElement('li');
                        fLi.id = `f-${fruitKey}`;
                        fLi.className = `flex justify-between items-center ${itemColor} font-medium py-1`;
                        fLi.innerHTML = `<p>${fruitKey}</p><span class="text-lg font-bold">x1</span>`;
                        if (fruitCollectionList) fruitCollectionList.appendChild(fLi);
                    } else {
                        fLi.querySelector('span').textContent = `x${fruitCollection[fruitKey]}`;
                    }
                }
            }

            function processOpening(amount) {
                if (!currentMode) return;
                for (let i = 0; i < amount; i++) {
                    let reward;
                    switch (currentMode) {
                        case 'kraken': reward = isGreatKrakenActive ? getFruitReward(fruitRarityChances, true) : getRewardFromList(krakenRewards); if (reward?.name === "Devil Fruit") reward = getFruitReward(fruitRarityChances, true); break;
                        case 'baal': reward = getRewardFromList(baalRewards); break;
                        case 'juzo': reward = getRewardFromList(juzoRewards); break;
                        case 'hawkEye': reward = getRewardFromList(hawkEyeRewards); break;
                        case 'roger': reward = getRewardFromList(rogerRewards); break;
                        case 'law': reward = getRewardFromList(lawRewards); break;
                        case 'gravito': reward = getRewardFromList(gravitoRewards); break;
                        case 'christmasPresents': reward = getRewardFromList(christmasRewards); break;
                        case 'legendaryChest': reward = getFruitReward(lfcRarityChances, false); break;
                        case 'mythicalChest': reward = getFruitReward(mfcRarityChances, false); break;
                        case 'rareChest': reward = getFruitReward(rfcRarityChances, false); break;
                    }
                    displayReward(reward);
                }
                killCount += amount;
                if (killCountEl) killCountEl.textContent = killCount;
            }

            if (clickTarget) {
                clickTarget.addEventListener('click', () => {
                    clickCount++;
                    if (clickCountDisplay) clickCountDisplay.textContent = `${clickCount} / ${CLICKS_PER_KILL}`;
                    if (clickCount >= CLICKS_PER_KILL) {
                        clickCount = 0;
                        if (clickCountDisplay) clickCountDisplay.textContent = `0 / ${CLICKS_PER_KILL}`;
                        processOpening(1);
                    }
                });
            }

            // Массовое открытие
            btnX1?.addEventListener('click', () => processOpening(1));
            btnX10?.addEventListener('click', () => processOpening(10));
            btnX100?.addEventListener('click', () => processOpening(100));

            // Listeners
            if (imageUpload) imageUpload.addEventListener('change', e => { const f = e.target.files[0]; if (f) { const r = new FileReader(); r.onload = ev => clickTarget.src = ev.target.result; r.readAsDataURL(f); } });
            if (toggleASE) toggleASE.addEventListener('change', e => { isASEActive = e.target.checked; updateAllChanceUI(); });
            if (toggleLogia) toggleLogia.addEventListener('change', e => { isLogiaActive = e.target.checked; updateAllChanceUI(); });
            if (toggleGreatKraken) toggleGreatKraken.addEventListener('change', e => isGreatKrakenActive = e.target.checked);
            if (toggle2xDrop) toggle2xDrop.addEventListener('change', e => { is2xDropActive = e.target.checked; if (is2xDropActive) { is4xDropActive = false; if (toggle4xDrop) toggle4xDrop.checked = false; } updateAllChanceUI(); });
            if (toggle4xDrop) toggle4xDrop.addEventListener('change', e => { is4xDropActive = e.target.checked; if (is4xDropActive) { is2xDropActive = false; if (toggle2xDrop) toggle2xDrop.checked = false; } updateAllChanceUI(); });
            if (toggleLFCLogia) toggleLFCLogia.addEventListener('change', e => { isLFCLogiaActive = e.target.checked; updateAllChanceUI(); });
            if (toggleRFCRLogia) toggleRFCRLogia.addEventListener('change', e => { isRFCRLogiaActive = e.target.checked; updateAllChanceUI(); });

            modes.forEach(m => selectors[m]?.addEventListener('click', () => setGameMode(m.charAt(0).toLowerCase() + m.slice(1))));
            if (resetModeButton) resetModeButton.addEventListener('click', () => { gameContainer.classList.add('hidden'); modeSelector.classList.remove('hidden'); resetGame(); });

        });
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #2d3748; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background-color: #4a5568; border-radius: 10px; border: 2px solid #2d3748; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background-color: #718096; }
        .toggle-checkbox:checked { right: 0; }
        .toggle-checkbox-green:checked { border-color: #48bb78; }
        .toggle-checkbox-green:checked+.toggle-label-green { background-color: #48bb78; }
        .toggle-checkbox-yellow:checked { border-color: #ecc94b; }
        .toggle-checkbox-yellow:checked+.toggle-label-yellow { background-color: #ecc94b; }
        .toggle-checkbox-blue:checked { border-color: #4299e1; }
        .toggle-checkbox-blue:checked+.toggle-label-blue { background-color: #4299e1; }
        .toggle-checkbox-purple:checked { border-color: #9f7aea; }
        .toggle-checkbox-purple:checked+.toggle-label-purple { background-color: #9f7aea; }
    </style>
</head>

<body class="bg-gray-900 text-gray-200 font-sans leading-normal tracking-normal min-h-screen flex items-center justify-center p-4">

    <!-- 1. Экран Выбора Режима -->
    <div id="modeSelector" class="w-full max-w-7xl relative">
        <h1 class="text-4xl font-bold text-center text-white mb-8">Выберите Режим</h1>
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
            <div id="selectKraken" class="mode-card bg-gray-800 p-6 rounded-lg shadow-lg cursor-pointer transition-all duration-300 hover:shadow-2xl hover:scale-105 border border-gray-700 flex flex-col justify-center items-center h-40"><h2 class="text-2xl font-semibold text-white text-center">Kraken Clicker</h2></div>
            <div id="selectBaal" class="mode-card bg-gray-800 p-6 rounded-lg shadow-lg cursor-pointer transition-all duration-300 hover:shadow-2xl hover:scale-105 border border-gray-700 flex flex-col justify-center items-center h-40"><h2 class="text-2xl font-semibold text-orange-500 text-center">True Ba'al Clicker</h2></div>
            <div id="selectJuzo" class="mode-card bg-gray-800 p-6 rounded-lg shadow-lg cursor-pointer transition-all duration-300 hover:shadow-2xl hover:scale-105 border border-gray-700 flex flex-col justify-center items-center h-40"><h2 class="text-2xl font-semibold text-white text-center">Juzo Clicker</h2></div>
            <div id="selectHawkEye" class="mode-card bg-gray-800 p-6 rounded-lg shadow-lg cursor-pointer transition-all duration-300 hover:shadow-2xl hover:scale-105 border border-gray-700 flex flex-col justify-center items-center h-40"><h2 class="text-2xl font-semibold text-white text-center">Hawk Eye Clicker</h2></div>
            <div id="selectRoger" class="mode-card bg-gray-800 p-6 rounded-lg shadow-lg cursor-pointer transition-all duration-300 hover:shadow-2xl hover:scale-105 border border-gray-700 flex flex-col justify-center items-center h-40"><h2 class="text-2xl font-semibold text-white text-center">Roger Clicker</h2></div>
            <div id="selectLaw" class="mode-card bg-gray-800 p-6 rounded-lg shadow-lg cursor-pointer transition-all duration-300 hover:shadow-2xl hover:scale-105 border border-gray-700 flex flex-col justify-center items-center h-40"><h2 class="text-2xl font-semibold text-white text-center">Law Clicker</h2></div>
            <div id="selectGravito" class="mode-card bg-gray-800 p-6 rounded-lg shadow-lg cursor-pointer transition-all duration-300 hover:shadow-2xl hover:scale-105 border border-gray-700 flex flex-col justify-center items-center h-40"><h2 class="text-2xl font-semibold text-white text-center">Gravito Clicker</h2></div>
            <div id="selectChristmasPresents" class="mode-card bg-green-900 p-6 rounded-lg shadow-lg cursor-pointer transition-all duration-300 hover:shadow-2xl hover:scale-105 border border-green-500 flex flex-col justify-center items-center h-40"><h2 class="text-2xl font-semibold text-white text-center">Christmas Presents</h2></div>
            <div id="selectLegendaryChest" class="mode-card bg-gray-800 p-6 rounded-lg shadow-lg cursor-pointer transition-all duration-300 hover:shadow-2xl hover:scale-105 border border-gray-700 flex flex-col justify-center items-center h-40"><h2 class="text-2xl font-semibold text-yellow-400 text-center">Legendary Fruit Chest</h2></div>
            <div id="selectMythicalChest" class="mode-card bg-gray-800 p-6 rounded-lg shadow-lg cursor-pointer transition-all duration-300 hover:shadow-2xl hover:scale-105 border border-gray-700 flex flex-col justify-center items-center h-40"><h2 class="text-2xl font-semibold text-red-500 text-center">Mythical Fruit Chest</h2></div>
            <div id="selectRareChest" class="mode-card bg-gray-800 p-6 rounded-lg shadow-lg cursor-pointer transition-all duration-300 hover:shadow-2xl hover:scale-105 border border-gray-700 flex flex-col justify-center items-center h-40"><h2 class="text-2xl font-semibold text-blue-400 text-center">Rare Fruit Chest</h2></div>
        </div>
    </div>

    <!-- 2. Главный Интерфейс -->
    <div id="gameContainer" class="hidden w-full max-w-7xl mx-auto p-4">
        <button id="resetModeButton" class="absolute top-4 left-4 bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg shadow-md z-10">Сменить Режим</button>
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Левая колонка -->
            <div class="lg:col-span-1 bg-gray-800 p-6 rounded-lg border border-gray-700 flex flex-col items-center">
                <h2 id="clickerTitle" class="text-3xl font-bold text-white mb-4 uppercase tracking-tighter">...</h2>
                <input type="file" id="imageUpload" accept="image/*" class="block w-full text-sm text-gray-400 mb-4 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:bg-cyan-600 file:text-white cursor-pointer">
                <div id="clickArea" class="w-full h-80 bg-gray-700 rounded-lg flex items-center justify-center mb-4 border-2 border-dashed border-gray-500 cursor-pointer">
                    <img id="clickTarget" src="https://placehold.co/300x300?text=Click+Me" class="max-w-full max-h-full rounded-lg object-contain transition-transform duration-75 active:scale-95">
                </div>
                
                <!-- Блок кнопок открытия -->
                <div class="flex gap-2 w-full mb-4">
                    <button id="btnX1" class="flex-1 bg-gray-700 hover:bg-gray-600 py-2 rounded-lg font-bold transition">x1</button>
                    <button id="btnX10" class="flex-1 bg-cyan-700 hover:bg-cyan-600 py-2 rounded-lg font-bold transition">x10</button>
                    <button id="btnX100" class="flex-1 bg-purple-700 hover:bg-purple-600 py-2 rounded-lg font-bold transition">x100</button>
                </div>

                <div class="text-center">
                    <h3 class="text-xl font-semibold text-gray-300">Клики:</h3>
                    <p id="clickCountDisplay" class="text-5xl font-bold text-white">0 / 1</p>
                </div>
            </div>

            <!-- Средняя колонка -->
            <div class="lg:col-span-1 bg-gray-800 p-6 rounded-lg border border-gray-700">
                <div class="mb-4">
                    <h3 class="text-2xl font-semibold text-white mb-3 border-b border-gray-700 pb-2">Статистика</h3>
                    <div class="flex justify-between mb-2"><span id="killCountLabel">Убито:</span><span id="killCount" class="text-2xl font-bold text-white">0</span></div>
                    
                    <div class="space-y-3 mt-4">
                        <div class="flex items-center justify-between">
                            <span class="text-cyan-400">2x Drop Chance</span>
                            <label class="relative inline-block w-10 h-6 select-none cursor-pointer">
                                <input type="checkbox" id="toggle2xDrop" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer z-10"/>
                                <span class="toggle-label-blue block overflow-hidden h-6 rounded-full bg-gray-600"></span>
                            </label>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-purple-400 font-bold">4x Drop Chance</span>
                            <label class="relative inline-block w-10 h-6 select-none cursor-pointer">
                                <input type="checkbox" id="toggle4xDrop" class="toggle-checkbox-purple toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer z-10"/>
                                <span class="toggle-label-purple block overflow-hidden h-6 rounded-full bg-gray-600"></span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="mb-4">
                    <h3 class="text-2xl font-semibold text-white mb-3 border-b border-gray-700 pb-2">Последний дроп</h3>
                    <div id="lastDropDisplay" class="text-center text-gray-400 p-4 bg-gray-900 rounded-lg min-h-[60px] flex items-center justify-center">Нажми 1 раз...</div>
                </div>

                <!-- Блоки шансов -->
                <div id="chancesContainer" class="space-y-4">
                    <div id="krakenChances" class="chance-block">
                        <ul class="space-y-1 text-lg">
                            <li><span class="text-gray-400">Mysterious Book (<span id="chance-k-book">15</span>%)</span></li>
                            <li><span class="text-green-400">Book of Spirits (<span id="chance-k-spirits">45</span>%)</span></li>
                            <li><span class="text-red-500">Kraken Armor (<span id="chance-k-armor">1</span>%)</span></li>
                            <li><span class="text-yellow-400">Kraken Cape (<span id="chance-k-cape">5</span>%)</span></li>
                            <li><span class="text-red-500">Kraken Blade (<span id="chance-k-blade">1</span>%)</span></li>
                            <li><span class="text-red-500">Kraken Katana (<span id="chance-k-katana">1</span>%)</span></li>
                            <li><span class="text-red-500">Kraken Core (<span id="chance-k-core">1</span>%)</span></li>
                            <li><span class="text-purple-400">Devil Fruit (<span id="chance-k-fruit">1</span>%)</span></li>
                        </ul>
                        <div class="flex items-center justify-between mt-4 p-3 bg-gray-900 rounded-lg">
                            <span class="text-green-400">Great Kraken (100% Fruit)</span>
                            <label class="relative inline-block w-10 h-6 select-none cursor-pointer">
                                <input type="checkbox" id="toggleGreatKraken" class="toggle-checkbox-green toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer z-10"/>
                                <span class="toggle-label-green block overflow-hidden h-6 rounded-full bg-gray-600"></span>
                            </label>
                        </div>
                    </div>
                    <div id="baalChances" class="chance-block hidden">
                        <ul class="space-y-1 text-sm">
                            <li class="text-yellow-400 font-bold text-lg">Snake Fire (<span id="chance-b-fire">20</span>%)</li>
                            <li class="text-purple-400">Snake Head (<span id="chance-b-head">5</span>%)</li>
                            <li class="text-purple-400">Ba'al Guard (<span id="chance-b-guard">2</span>%)</li>
                            <li class="text-red-500">World Ender (<span id="chance-b-worldender">1</span>%)</li>
                            <li class="text-red-500 font-bold italic">Prestige WE (<span id="chance-b-prestige">0.001</span>%)</li>
                        </ul>
                    </div>
                    <!-- Christmas -->
                    <div id="christmasPresentsChances" class="chance-block hidden">
                        <ul class="space-y-1 text-lg">
                            <li class="text-black font-bold">Iceborn candy cane (<span id="chance-xm-cane-ice">0.001</span>%)</li>
                            <li class="text-red-400">Candy cane (<span id="chance-xm-cane-regular">0.005</span>%)</li>
                            <li class="text-gray-500">Ничего (<span id="chance-xm-nothing">99.994</span>%)</li>
                        </ul>
                    </div>
                    
                    <!-- Fruit Chances -->
                    <div id="fruitChancesContainer" class="mt-6 border-t border-gray-700 pt-4">
                        <h3 class="text-xl font-bold mb-3 uppercase tracking-wider text-cyan-500">ШАНСЫ FRUIT</h3>
                        <div class="flex gap-4 mb-4">
                            <div class="flex items-center">
                                <span class="text-yellow-400 mr-2 font-bold text-sm">ASE</span>
                                <input type="checkbox" id="toggleASE" class="w-5 h-5 cursor-pointer">
                            </div>
                            <div class="flex items-center">
                                <span class="text-blue-400 mr-2 font-bold text-sm">2x Logia</span>
                                <input type="checkbox" id="toggleLogia" class="w-5 h-5 cursor-pointer">
                            </div>
                        </div>
                        <ul class="space-y-1">
                            <li>Common: <span id="chanceCommon">59.5</span>%</li>
                            <li class="text-blue-400">Rare: <span id="chanceRare">26</span>%</li>
                            <li class="text-purple-400">Epic: <span id="chanceEpic">10</span>%</li>
                            <li class="text-yellow-400">Legendary: <span id="chanceLegendary">4</span>%</li>
                            <li class="text-red-500 font-bold">Mythical: <span id="chanceMythical">0.5</span>%</li>
                        </ul>
                    </div>
                    
                    <!-- Chest UI -->
                    <div id="legendaryChestChances" class="chance-block hidden">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-blue-400">2x Logia</span>
                            <input type="checkbox" id="toggleLFCLogia" class="w-5 h-5">
                        </div>
                        <p class="text-yellow-400 font-bold">Legendary / Mythical Only</p>
                    </div>
                    <div id="rareChestChances" class="chance-block hidden">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-blue-400">2x Logia</span>
                            <input type="checkbox" id="toggleRFCRLogia" class="w-5 h-5">
                        </div>
                        <p class="text-blue-400 font-bold">Rare and Above</p>
                    </div>
                    
                    <!-- Режимы без специальных шансов -->
                    <div id="juzoChances" class="chance-block hidden"><p class="text-gray-400 text-sm">Шансы Juzo активны.</p></div>
                    <div id="hawkEyeChances" class="chance-block hidden"><p class="text-gray-400 text-sm">Шансы Hawk Eye активны.</p></div>
                    <div id="rogerChances" class="chance-block hidden"><p class="text-gray-400 text-sm">Шансы Roger активны.</p></div>
                    <div id="lawChances" class="chance-block hidden"><p class="text-gray-400 text-sm">Шансы Law активны.</p></div>
                    <div id="gravitoChances" class="chance-block hidden"><p class="text-gray-400 text-sm">Шансы Gravito активны.</p></div>
                </div>
            </div>

            <!-- Правая колонка -->
            <div class="lg:col-span-1 bg-gray-800 p-6 rounded-lg border border-gray-700 flex flex-col max-h-[80vh]">
                <h3 class="text-xl font-bold mb-2 uppercase text-gray-400">История дропа</h3>
                <ul id="dropList" class="custom-scrollbar h-48 overflow-y-auto space-y-1 bg-gray-900 p-2 rounded mb-4"></ul>
                <h3 class="text-xl font-bold mb-2 uppercase text-gray-400">Коллекция</h3>
                <ul id="fruitCollectionList" class="custom-scrollbar flex-grow overflow-y-auto space-y-1 bg-gray-900 p-2 rounded"></ul>
            </div>
        </div>
    </div>
</body>
</html>